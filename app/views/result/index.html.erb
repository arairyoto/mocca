<%= provide(:title, "Result") %>

<!--Slick-->
<link href="/slick/slick.css" type="text/css" rel="stylesheet">
<link href="/slick/slick-theme.css" type="text/css" rel="stylesheet">
<script src="/slick/slick.js"></script>

<link href="/layout/css/slider.css" type="text/css" rel="stylesheet">
<script src="/layout/js/slider.js"></script>

<link href="/layout/css/result.css" type="text/css" rel="stylesheet">
    
<!--**********Main Script Start**********-->
<%= javascript_tag do %>
  window.onload=init;
  
  function init(){
  function getXMLHttpRequestObject(){
    var ajax=null;
    if(window.XMLHttpRequest){
        ajax=new XMLHttpRequest();
    } else if (window.ActiveObject){
        ajax=new ActiveObject('MSXML2.XMLHTTP.3.0');
    }
    return ajax;
  }
  
  var ajax=getXMLHttpRequestObject();
    
  var hearts     = document.getElementsByClassName("heart");
  var giftnames  = document.getElementsByClassName("giftname");
  var gifturls   = document.getElementsByClassName("gifturl");
  var giftimgs   = document.getElementsByClassName("giftimg");
  var giftcontents = document.getElementsByClassName("giftcontent");
  var companynames = document.getElementsByClassName("companyname");
  var prices = document.getElementsByClassName("price");
  var pricetags = document.getElementsByClassName("price_tags");
  
  i=1;
  hiduke=new Date();
  <% @giftRes.each do |exp| %>
  giftnames[i].innerText= "<%= exp.name %>";
  gifturls[i].href = "<%= exp.url %>";
  gifturls[i].style ="background-image: url('/gifts/<%= exp.id %>/img');";
  companynames[i].innerHTML= "<%= exp.company_name %>";
  var price_num="<%= exp.price %>";
  if (price_num!="") {
  
    switch(price_num){
    
    case "1":
      elements=pricetags[i].getElementsByClassName("price_tag");
      elements[0].className+= " emph_1";
      gifturls[i].className+= " emph_line_1";
      break;
    case "2":
      elements=pricetags[i].getElementsByClassName("price_tag");
      elements[1].className+= " emph_2";
      gifturls[i].className+= " emph_line_2";
      break;
    case "3":
      elements=pricetags[i].getElementsByClassName("price_tag");
      elements[2].className+= " emph_3";
      gifturls[i].className+= " emph_line_3";
      break;
    case "4":
      elements=pricetags[i].getElementsByClassName("price_tag");
      elements[3].className+= " emph_4";
      gifturls[i].className+= " emph_line_4";
      break;
    case "5":
      elements=pricetags[i].getElementsByClassName("price_tag");
      elements[4].className+= " emph_5";
      gifturls[i].className+= " emph_line_5";
      break;
    default:
      break;
    }
  } else {
  
    }
  
  var h1y=hiduke.getFullYear();
  var h1d=hiduke.getDate()+hiduke.getMonth()*30.5;
  var h2y=<%= exp.created_at.year %>;
  var h2d=<%= exp.created_at.yday %>;
  var sa=h1y*365+h1d-h2y*365-h2d;
  if(sa<30){
    element=document.createElement("span");
    element.className="new";
    element.innerHTML="NEW";
    giftcontents[i].appendChild(element);
  }
  i++;
  <% end %>
  
  j=1;
  elm_num=[0,0,0,0,0,0,0,0];
  
  
  <% @giftRes.each do |exp| %>
  hearts[j].onclick = function(s) {
    return function(event) {
           switch(elm_num[s]) {
              case -1:
                hearts[s].src = "/image/emptyheart2.png";
                ajax.onreadystatechange=function() {
                  if(ajax.readyState==4) {
                    if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    }
                    else {
                    }
                  }
                }
                ajax.open('GET','/result/countup?gift=<%= exp.id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
                ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
                ajax.send(null);
                elm_num[s]=0;
                break;
              case 0:
                hearts[s].src = "/image/heart.png";
                ajax.onreadystatechange=function() {
                  if(ajax.readyState==4) {
                    if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    }
                    else {
                    }
                  }
                }
                ajax.open('GET','/result/countup?gift=<%= exp.id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
                ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
                ajax.send(null);
                elm_num[s]=1;
                break;
              case 1:
                hearts[s].src = "/image/dislike.png";
                ajax.onreadystatechange=function() {
                  if(ajax.readyState==4) {
                    if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    }
                    else {
                    }
                  }
                }
                ajax.open('GET','/result/countdown2?gift=<%= exp.id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
                ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
                ajax.send(null);
                elm_num[s]=-1;
                break;
                }
      }
  }(j)
  j++;
  <% end %>
        
  // 質問がなくなった際に，Continueできなくする
  continuebtn=document.getElementById("continuebtn");
  if (<%= @continue_display %>==1 ) {
    continuebtn.style="display: none;";
  }
  else {
  }

  }
<% end %>
<!--**********Main Script End**********-->


  
  <div class="row">
    <div id="slick_container">
    <div class="colmn slick single-item">
      <!------------------------------------------------------------------------>
      <!-- Gift Start -->
      <div class="gift">
        <!-- Header Start -->
        <div class="giftheader">
          <h2 class="giftname"></h2>
          <h5 class="companyname"></h5>
          
          <img class="heart" src="/image/emptyheart2.png">
        </div>
        <!-- Header End -->
        <!-- Gift Content Start -->
        <div class="giftcontent">
          <!--<div class="price"></div>-->
          <a class="gifturl" target="_blank"></a>
          <div class="price_tags">
            <div class="price_tag"><p>～</p><p>2千円</p></div>
            <div class="price_tag"><p>2千円</p><p>～</p><p>5千円</p></div>
            <div class="price_tag"><p>5千円</p><p>～</p><p>1万円</p></div>
            <div class="price_tag"><p>1万円</p><p>～</p><p>3万円</p></div>
            <div class="price_tag"><p>3万円</p><p>～</p></div>  
          </div>
        </div>
        <!-- Gift Content End -->
      </div>
      <!-- Gift End -->
      <!------------------------------------------------------------------------>
      <!-- Gift Start -->
      <div class="gift">
        <!-- Header Start -->
        <div class="giftheader">
          <h2 class="giftname"></h2>
          <h5 class="companyname"></h5>
          
          <img class="heart" src="/image/emptyheart2.png">
        </div>
        <!-- Header End -->
        <!-- Gift Content Start -->
        <div class="giftcontent">
          <!--<div class="price"></div>-->
          <a class="gifturl" target="_blank"></a>
          <div class="price_tags">
            <div class="price_tag"><p>～</p><p>2千円</p></div>
            <div class="price_tag"><p>2千円</p><p>～</p><p>5千円</p></div>
            <div class="price_tag"><p>5千円</p><p>～</p><p>1万円</p></div>
            <div class="price_tag"><p>1万円</p><p>～</p><p>3万円</p></div>
            <div class="price_tag"><p>3万円</p><p>～</p></div>  
          </div>
        </div>
        <!-- Gift Content End -->
      </div>
      <!-- Gift End -->
      <!------------------------------------------------------------------------>
      <!-- Gift Start -->
      <div class="gift">
        <!-- Header Start -->
        <div class="giftheader">
          <h2 class="giftname"></h2>
          <h5 class="companyname"></h5>
          
          <img class="heart" src="/image/emptyheart2.png">
        </div>
        <!-- Header End -->
        <!-- Gift Content Start -->
        <div class="giftcontent">
          <!--<div class="price"></div>-->
          <a class="gifturl" target="_blank"></a>
          <div class="price_tags">
            <div class="price_tag"><p>～</p><p>2千円</p></div>
            <div class="price_tag"><p>2千円</p><p>～</p><p>5千円</p></div>
            <div class="price_tag"><p>5千円</p><p>～</p><p>1万円</p></div>
            <div class="price_tag"><p>1万円</p><p>～</p><p>3万円</p></div>
            <div class="price_tag"><p>3万円</p><p>～</p></div>  
          </div>
        </div>
        <!-- Gift Content End -->
      </div>
      <!-- Gift End -->
      <!------------------------------------------------------------------------>
      <!-- Gift Start -->
      <div class="gift">
        <!-- Header Start -->
        <div class="giftheader">
          <h2 class="giftname"></h2>
          <h5 class="companyname"></h5>
          
          <img class="heart" src="/image/emptyheart2.png">
        </div>
        <!-- Header End -->
        <!-- Gift Content Start -->
        <div class="giftcontent">
          <!--<div class="price"></div>-->
          <a class="gifturl" target="_blank"></a>
          <div class="price_tags">
            <div class="price_tag"><p>～</p><p>2千円</p></div>
            <div class="price_tag"><p>2千円</p><p>～</p><p>5千円</p></div>
            <div class="price_tag"><p>5千円</p><p>～</p><p>1万円</p></div>
            <div class="price_tag"><p>1万円</p><p>～</p><p>3万円</p></div>
            <div class="price_tag"><p>3万円</p><p>～</p></div>  
          </div>
        </div>
        <!-- Gift Content End -->
      </div>
      <!-- Gift End -->
      <!------------------------------------------------------------------------>
      <!-- Gift Start -->
      <div class="gift">
        <!-- Header Start -->
        <div class="giftheader">
          <h2 class="giftname"></h2>
          <h5 class="companyname"></h5>
          
          <img class="heart" src="/image/emptyheart2.png">
        </div>
        <!-- Header End -->
        <!-- Gift Content Start -->
        <div class="giftcontent">
          <!--<div class="price"></div>-->
          <a class="gifturl" target="_blank"></a>
          <div class="price_tags">
            <div class="price_tag"><p>～</p><p>2千円</p></div>
            <div class="price_tag"><p>2千円</p><p>～</p><p>5千円</p></div>
            <div class="price_tag"><p>5千円</p><p>～</p><p>1万円</p></div>
            <div class="price_tag"><p>1万円</p><p>～</p><p>3万円</p></div>
            <div class="price_tag"><p>3万円</p><p>～</p></div>  
          </div>
        </div>
        <!-- Gift Content End -->
      </div>
      <!-- Gift End -->
      <!------------------------------------------------------------------------>
      <!-- Gift Start -->
      <div class="gift">
        <!-- Header Start -->
        <div class="giftheader">
          <h2 class="giftname"></h2>
          <h5 class="companyname"></h5>
          
          <img class="heart" src="/image/emptyheart2.png">
        </div>
        <!-- Header End -->
        <!-- Gift Content Start -->
        <div class="giftcontent">
          <!--<div class="price"></div>-->
          <a class="gifturl" target="_blank"></a>
          <div class="price_tags">
            <div class="price_tag"><p>～</p><p>2千円</p></div>
            <div class="price_tag"><p>2千円</p><p>～</p><p>5千円</p></div>
            <div class="price_tag"><p>5千円</p><p>～</p><p>1万円</p></div>
            <div class="price_tag"><p>1万円</p><p>～</p><p>3万円</p></div>
            <div class="price_tag"><p>3万円</p><p>～</p></div>  
          </div>
        </div>
        <!-- Gift Content End -->
      </div>
      <!-- Gift End -->
      <!------------------------------------------------------------------------>
    </div>
    <div id="arrows">
      <div class="slick-prev">
        <img src="/image/left.png" height="200px" width="50px" alt="">
      </div>
      <div class="slick-next">
        <img src="/image/right.png"  height="200px" width="50px" alt="">
      </div>
    </div>
    </div>
  </div>
        
  <div class="row">
    <div class="col-xs-2"></div>
    <div class="col-xs-4">
      <a href="/qflow_continue" data-no-turbolink="1" class="tabtn continue" id="continuebtn"></a>
    </div>
    <div class="col-xs-4">
      <a href="/qflow" data-no-turbolink="1" class="tabtn findfor"></a>
    </div>
    <div class="col-xs-2">
    </div>
  </div>