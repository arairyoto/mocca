
<!DOCTYPE html>
<html>
<!-- MEMO: update me with `git checkout gh-pages && git merge master && git push origin gh-pages` -->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!--JQuery-->
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    
    <!-- Material Design fonts -->
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <!-- Bootstrap -->
    <link href="/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    
    <!-- Bootstrap Material Design -->
    <link href="/dist/css/bootstrap-material-design.css" rel="stylesheet">
    <link href="/dist/css/ripples.min.css" rel="stylesheet">
    <script src="/dist/js/ripples.min.js"></script>
    <script src="/dist/js/material.min.js"></script>
    
    <script>
    
      (function () {
    
        var $button = $("<div id='source-button' class='btn btn-primary btn-xs'>&lt; &gt;</div>").click(function () {
          var index = $('.bs-component').index($(this).parent());
          $.get(window.location.href, function (data) {
            var html = $(data).find('.bs-component').eq(index).html();
            html = cleanSource(html);
            $("#source-modal pre").text(html);
            $("#source-modal").modal();
          })
    
        });
    
        $('.bs-component [data-toggle="popover"]').popover();
        $('.bs-component [data-toggle="tooltip"]').tooltip();
    
        $(".bs-component").hover(function () {
          $(this).append($button);
          $button.show();
        }, function () {
          $button.hide();
        });
    
        function cleanSource(html) {
          var lines = html.split(/\n/);
    
          lines.shift();
          lines.splice(-1, 1);
    
          var indentSize = lines[0].length - lines[0].trim().length,
              re = new RegExp(" {" + indentSize + "}");
    
          lines = lines.map(function (line) {
            if (line.match(re)) {
              line = line.substring(indentSize);
            }
    
            return line;
          });
    
          lines = lines.join("\n");
    
          return lines;
        }
    
        $(".icons-material .icon").each(function () {
          $(this).after("<br><br><code>" + $(this).attr("class").replace("icon ", "") + "</code>");
        });
    
      })();
    
    </script>
    
    <!--Slick-->
    <link href="/slick/slick.css" type="text/css" rel="stylesheet">
    <link href="/slick/slick-theme.css" type="text/css" rel="stylesheet">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js" type="text/javascript" ></script>
    <script src="/slick/slick.min.js"></script>
    
    <script>
    
      $(function() {
      $('.single-item').slick({appendArrows: $('.arrows')});
      });
      
    </script>
    
    <title>GiftApp Res</title>
    
    <!--**********Main Script Start**********-->
    <%= javascript_tag do %>
        window.onload=init;
        
        function init(){
        function getXMLHttpRequestObject(){
            var ajax=null;
            if(window.XMLHttpRequest){
                ajax=new XMLHttpRequest();
            } else if (window.ActiveObject){
                ajax=new ActiveObject('MSXML2.XMLHTTP.3.0');
            }
            return ajax;
        }
        function handleStateChange(){
            if(ajax.readyState==4){
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup1').src="/image/heart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
            }
        }
        var ajax=getXMLHttpRequestObject();
        // ajax.onreadystatechange=handleStateChange;
        
        btnup1=document.getElementById("btnup1");
        btnup2=document.getElementById("btnup2");
        btnup3=document.getElementById("btnup3");
        btnup4=document.getElementById("btnup4");
        btnup5=document.getElementById("btnup5");
        btnup6=document.getElementById("btnup6");
        i= [0,0,0,0,0,0];
        
        btnup1.onclick = function() {
            if(i[0]%2==0) {
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup1').src="/image/heart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countup?gift=<%= @expTop3[0].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[0]++;
            }
            else{
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup1').src="/image/emptyheart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countdown?gift=<%= @expTop3[0].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[0]++;
            }
        }
        btnup2.onclick = function(){
            if(i[1]%2==0) {
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup2').src="/image/heart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countup?gift=<%= @dispTop3[0].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[1]++;
            }
            else{
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup2').src="/image/emptyheart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countdown?gift=<%= @dispTop3[0].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[1]++;
            }
            
        }
        btnup3.onclick = function() {
            if(i[2]%2==0) {
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup3').src="/image/heart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countup?gift=<%= @expTop3[1].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[2]++;
            }
            else{
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup3').src="/image/emptyheart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countdown?gift=<%= @expTop3[1].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[2]++;
            }
        }
        btnup4.onclick = function(){
            if(i[3]%2==0) {
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup4').src="/image/heart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countup?gift=<%= @dispTop3[1].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[3]++;
            }
            else{
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup4').src="/image/emptyheart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countdown?gift=<%= @dispTop3[1].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[3]++;
            }
            
        }
        btnup5.onclick = function() {
            if(i[4]%2==0) {
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup5').src="/image/heart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countup?gift=<%= @expTop3[2].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[4]++;
            }
            else{
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup5').src="/image/emptyheart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countdown?gift=<%= @expTop3[2].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[4]++;
            }
        }
        btnup6.onclick = function(){
            if(i[5]%2==0) {
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup6').src="/image/heart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countup?gift=<%= @dispTop3[2].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[5]++;
            }
            else{
            ajax.onreadystatechange=function() {
              if(ajax.readyState==4) {
                if((ajax.status>=200 && ajax.status<300) || (ajax.status==304)) {
                    document.getElementById('output').innerHTML=ajax.responseText;
                    document.getElementById('btnup6').src="/image/emptyheart.png";
                }
                else {
                    document.getElementById('output').innerHTML=ajax.statusText;
                }
              }
            }
            ajax.open('GET','/result/countdown?gift=<%= @dispTop3[2].id %>&gift_ans=<%= @ansarray.join(",") %>&gift_q=<%= @qarray.join(",") %>',true);
            ajax.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
            ajax.send(null);
            i[5]++;
            }
            
        }
        continuebtn=document.getElementById("continuebtn");
        if (<%= @continue_display %>==1 ) {
          continuebtn.href="javascript:void(0)";
          continuebtn.onclick = function() {
              continuebtn.innerHTML="<font size='5em' color='#FFFFFF'>No Question Left</font>";
          }
        }
        else {
        }
        
        }
    <% end %>
    <!--**********Main Script End**********-->
    
    <style>
      .question {
        margin-top: 5%;
      }
    
      body {
        position: relative;
        /*background-color: rgba(0,30,67,1);*/
        /*グラデーション試してみた*/
        /*background: linear-gradient(#1D62F0,#05FBFF) fixed;*/
        background: #ee9ca7; /* fallback for old browsers */
        background: -webkit-linear-gradient(#ee9ca7 , #ffdde1); /* Chrome 10-25, Safari 5.1-6 */
        background: linear-gradient(#ee9ca7 , #ffdde1); /* W3C, IE 10+/ Edge, Firefox 16+, Chrome 26+, Opera 12+, Safari 7+ */
          
      }
      
      /*Apprication Name*/
      .appname {
        margin-left: auto;
        margin-right: auto;
    
        background: url("/image/s_backlogo3.png");
        margin-top: 20px;;
        height: 199px;
        width: 400px;
      }
      .appname p {
        line-height: 199px;
        font-size: 5em;
        text-align: center;
        text-shadow: 1px 1px 10px #FFFFFF;
        /*color: #000;*/
        color: #FFFFFF;
      }
      
      /*Gift*/
      .evalbtn {
        width: 30px;
        height: 30px;
        float:right;
        margin-top: auto;
        margin-bottom: auto;
      }
      .heart {
        width: 30px;
        height: 30px;
      }
      
      .giftname {
          text-align: center;
          color: #FFFFFF;
      }
      
      .giftimg {
        margin-left:auto;
        margin-right:auto;
        /*Gift Imageの隅*/
        border-radius: 70px;
        height: 200px;
      }
      
      /* TryAgain,Continue Button */
    
      .nextbtn {
        text-align: center;
      }
      
      /* Slick */
      
      .slick_container1 {
          position:relative;
      }
      .slick_container2 {
          position:relative;
      }

       .slick-prev img, .slick-next img{
          width: 20px; /* 画像幅 */
          height: 20px; /* 画像高さ */
      }
      #arrows .slick-prev:before,#arrows .slick-next:before {
          content:"";
      }
      button.slick-prev, button.slick-next {
          z-index:2;
      }
      .slick-prev{
        position: absolute;
        left: 20px;
        top: 50px;
      }
      .slick-next{
        position: absolute;
        right: 20px;
        top:50px;
      }
      
      .slick-arrow{
        z-index: 10;
      }
    </style>
  
  </head>
  <body>
    <div class="appname">
      <p><strong>Result</strong></p>
    </div>
    <div class="question">
      <div class="container">
        <div class="row">
          <div class="col-xs-1">
          </div>
          <div class="slick_container1">
          <div class="col-xs-10 slider single-item">
              <!------------------------------------------------------------------------>
              <div class="row">
                <!-- Exp Gift Start -->
                <div class="col-xs-6">
                  <!-- Header Start -->
                  <div class="giftheader">
                    <h1 class="giftname name1">
                      <strong><%= @expTop3[0].name %></strong>
                      <div class="evalbtn">
                        <img class="heart" src="/image/emptyheart.png">
                      </div>
                    </h1>
                  </div>
                  <!-- Header End -->
                  <!-- Gift Content Start -->
                  <div class="giftcontent">
                    <div class="gift">
                      <a href="<%= @expTop3[0].url %>"><%= image_tag(img_gift_path(@expTop3[0]), :class => "giftimg") %></a>
                    </div>
                  </div>
                  <!-- Gift Content End -->
                </div>
                <!-- Exp Gift End -->
                <!-- Disp Gift Start -->
                <div class="col-xs-6">
                  <!-- Header -->
                  <div class="giftheader">
                    <h1 class="giftname name1">
                      <strong><%= @dispTop3[0].name %></strong>
                      <div class="evalbtn">
                        <img class="heart" src="/image/emptyheart.png">
                      </div>
                    </h1>
                  </div>
                  <!-- Header End -->
                  <div class="giftcontent">
                    <div class="gift">
                      <a href="<%= @dispTop3[0].url %>"><%= image_tag(img_gift_path(@dispTop3[0]), :class => "giftimg") %></a>
                    </div>
                  </div>
                </div>
                <!-- Disp Gift End -->
              </div>
              <!------------------------------------------------------------------------>
              <div class="row">
                <!-- Exp Gift Start -->
                <div class="col-xs-6">
                  <!-- Header Start -->
                  <div class="giftheader">
                    <h1 class="giftname name1"><strong><%= @expTop3[1].name %></strong></h1>
                    <div class="evalbtn">
                      <img class="heart" src="/image/emptyheart.png">
                    </div>
                  </div>
                  <!-- Header End -->
                  <!-- Gift Content Start -->
                  <div class="giftcontent">
                    <div class="gift">
                      <a href="<%= @expTop3[1].url %>"><%= image_tag(img_gift_path(@expTop3[1]), :class => "giftimg") %></a>
                    </div>
                  </div>
                  <!-- Gift Content End -->
                </div>
                <!-- Exp Gift End -->
                <!-- Disp Gift Start -->
                <div class="col-xs-6">
                  <!-- Header -->
                  <div class="giftheader">
                    <h1 class="giftname"><strong><%= @dispTop3[1].name %></strong></h1>
                    <div class="evalbtn">
                      <img class="heart" src="/image/emptyheart.png">
                    </div>
                  </div>
                  <!-- Header End -->
                  <div class="giftcontent">
                    <div class="gift">
                      <a href="<%= @dispTop3[1].url %>"><%= image_tag(img_gift_path(@dispTop3[1]), :class => "giftimg") %></a>
                    </div>
                  </div>
                </div>
                <!-- Disp Gift End -->
              </div>
              <!------------------------------------------------------------------------>
              <div class="row">
                <!-- Exp Gift Start -->
                <div class="col-xs-6">
                  <!-- Header Start -->
                  <div class="giftheader">
                    <h1 class="giftname name1"><strong><%= @expTop3[2].name %></strong></h1>
                    <div class="evalbtn">
                      <img class="heart" src="/image/emptyheart.png">
                    </div>
                  </div>
                  <!-- Header End -->
                  <!-- Gift Content Start -->
                  <div class="giftcontent">
                    <div class="gift">
                      <a href="<%= @expTop3[2].url %>"><%= image_tag(img_gift_path(@expTop3[2]), :class => "giftimg") %></a>
                    </div>
                  </div>
                  <!-- Gift Content End -->
                </div>
                <!-- Exp Gift End -->
                <!-- Disp Gift Start -->
                <div class="col-xs-6">
                  <!-- Header -->
                  <div class="giftheader">
                    <h1 class="giftname"><strong><%= @dispTop3[0].name %></strong></h1>
                    <div class="evalbtn">
                      <img class="heart" src="/image/emptyheart.png">
                    </div>
                  </div>
                  <!-- Header End -->
                  <div class="giftcontent">
                    <div class="gift">
                      <a href="<%= @dispTop3[2].url %>"><%= image_tag(img_gift_path(@dispTop3[2]), :class => "giftimg") %></a>
                    </div>
                  </div>
                </div>
                <!-- Disp Gift End -->
              </div>
              <!------------------------------------------------------------------------>
            </div>
            <!--Slickの矢印画像設定-->
            <div class="arrows">
              <div class="slick-next">
                  <img src="/image/heart.png" alt="→">
              </div>
              <div class="slick-prev">
                  <img src="/image/heart.png" alt="←">
              </div>
            </div>
            </div>
            <div class="col-xs-1">
            </div>
          </div>
          <br><br>
          <div class="row">
            <div class="col-xs-2"></div>
            <div class="col-xs-4 nextbtn">
                <a href="/qflow" class="btn btn-default"><font size="5em" color="#FFFFFF">Try Again &raquo;</font></a>
            </div>
            <div class="col-xs-4 nextbtn">
                <a href="/qflow_continue" class="btn btn-default" id="continuebtn" ><font size="5em" color="#FFFFFF">Continue &raquo;</font></a>
            </div>
            <div class="col-xs-2">
            </div>
          </div>
        </div>
      </div>
      <div class="slick_container2">
      <div class="container slider single-item" id="likes">
        <div><%= image_tag(img_gift_path(@Likes[0]), :height => "200px", :class => "giftimg") %></div>
        <div><%= image_tag(img_gift_path(@Likes[1]), :height => "200px", :class => "giftimg") %></div>
        <div><%= image_tag(img_gift_path(@Likes[2]), :height => "200px", :class => "giftimg") %></div>
        <div><%= image_tag(img_gift_path(@Likes[3]), :height => "200px", :class => "giftimg") %></div>
        <div><%= image_tag(img_gift_path(@Likes[4]), :height => "200px", :class => "giftimg") %></div>
      </div>
      <!--Slickの矢印画像設定-->
      <div class="arrows">
        <div class="slick-next">
            <img src="/image/heart.png" alt="→">
        </div>
        <div class="slick-prev">
            <img src="/image/heart.png" alt="←">
        </div>
      </div>
      </div>
      <br><br><br><br><br>
      <div class="console">
        ベイズ<%= @bayes.values %>
      <BR>
      期待値<%= @giftExp.values %>
      <BR>
      分散値<%= @giftDisp.values %>
      <BR>
      Question<%= @qarray.join(",") %>
      <p id="output"></p>
      </div>
    </div>
  </body>
</html>